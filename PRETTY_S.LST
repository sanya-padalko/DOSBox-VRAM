Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 1
pretty_s.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5	      =000A		     STR_LENGTH	     equ 10d
      6
      7				     locals @@
      8
      9	0100  E8 0003		     start:	     call Main
     10	0103  E8 0196				     call Exit
     11
     12
     13				     ;=====================================================
     14				     ; Entry:	     -
     15				     ;
     16				     ; Result:	     Program executed
     17				     ;
     18				     ; Expected:     -
     19				     ;
     20				     ; Destruction:  AX, BX, ES, DI, DS, SI, CL
     21				     ;=====================================================
     22	0106			     Main	     proc
     23
     24	0106  B8 0002				     mov ax, 02h
     25	0109  E8 0090				     call SkipStrings
     26
     27	010C  E8 00C6				     call GetLength
     28	010F  80 C1 02				     add cl, 2d
     29	0112  E8 00A5				     call CalcOffset
     30
     31	0115  50 55 8B EC C7 46	02+		     push 3h			     ; empty_strings
     32	      0003 5D
     33	011F  51				     push cx			     ; len of hor line
     34	0120  50 55 8B EC C7 46	02+		     push 8ac4h			     ; mid2
     35	      8AC4 5D
     36	012A  50 55 8B EC C7 46	02+		     push 8a03h			     ; mid1
     37	      8A03 5D
     38	0134  B8 8A2F				     mov ax, 8a2fh
     39	0137  8B D0				     mov dx, ax
     40	0139  BB 8A5C				     mov bx, 8a5ch
     41	013C  8B CB				     mov cx, bx
     42	013E  E8 00E4				     call DrawHorLines		     ; after DrawHorLines cx = len
     43
     44	0141  B8 0001				     mov ax, 1d
     45	0144  E8 0063				     call ChangeString
     46
     47	0147  51				     push cx
     48	0148  B8 8AB3				     mov ax, 8ab3h
     49	014B  BB 8AC3				     mov bx, 8ac3h
     50	014E  B9 8AB4				     mov cx, 8ab4h
     51	0151  E8 008B				     call DrawWalls		     ; after DrawWalls cx = len
     52
     53	0154  83 E9 02				     sub cx, 2d
     54	0157  83 C7 02				     add di, 2d
     55
     56	015A  50 55 8B EC C7 46	02+		     push 1h
     57	      0001 5D
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 2
pretty_s.asm



     58	0164  51				     push cx
     59	0165  50 55 8B EC C7 46	02+		     push 8cc4h
     60	      8CC4 5D
     61	016F  50 55 8B EC C7 46	02+		     push 8cc4h
     62	      8CC4 5D
     63	0179  B8 8CDA				     mov ax, 8cdah
     64	017C  BB 8CBF				     mov bx, 8cbfh
     65	017F  B9 8CC0				     mov cx, 8cc0h
     66	0182  BA 8CD9				     mov dx, 8cd9h
     67	0185  E8 009D				     call DrawHorLines
     68
     69	0188  B8 0001				     mov ax, 1d
     70	018B  E8 001C				     call ChangeString
     71
     72	018E  B8 8AC4				     mov ax, 8ac4h
     73	0191  AB				     stosw
     74
     75	0192  B4 CE				     mov ah, 0ceh
     76	0194  E8 002F				     call PrintString
     77
     78	0197  B8 8AC4				     mov ax, 8ac4h
     79	019A  AB				     stosw
     80
     81	019B  C3				     ret
     82	019C					     endp
     83				     ;-----------------------------------------------------
     84
     85
     86
     87				     ;=====================================================
     88				     ; Entry:	     AX	= count	of empty string	before frame
     89				     ;
     90				     ; Result:	     ES	on begin of (AX	+ 1)th string
     91				     ;
     92				     ; Expected:     1 < AX < 21, also expect that 2 string will be entered
     93				     ;
     94				     ; Destruction:  AX, ES, BX
     95				     ;=====================================================
     96	019C			     SkipStrings     proc
     97
     98	019C  05 0002				     add ax, 02h
     99	019F  BB 000A				     mov bx, 0ah
    100	01A2  F7 E3				     mul bx
    101	01A4  05 B800				     add ax, 0b800h
    102	01A7  8E C0				     mov es, ax
    103
    104	01A9  C3				     ret
    105	01AA					     endp
    106				     ;-----------------------------------------------------
    107
    108
    109
    110				     ;=====================================================
    111				     ; Entry:	     AX	= the number of	lines to change	to
    112				     ;		     ES	= ...
    113				     ; Result:	     ES	= old ES + AX strings
    114				     ;		     AX	= ES
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 3
pretty_s.asm



    115				     ; Expected:     -
    116				     ;
    117				     ; Destruction:  ES, AX
    118				     ;=====================================================
    119	01AA			     ChangeString    proc
    120
    121	01AA  53				     push bx
    122	01AB  52				     push dx
    123	01AC  BB 000A				     mov bx, 10d
    124	01AF  F7 E3				     mul bx
    125
    126	01B1  8C C3				     mov bx, es
    127	01B3  03 C3				     add ax, bx
    128	01B5  8E C0				     mov es, ax
    129
    130	01B7  5A				     pop dx
    131	01B8  5B				     pop bx
    132	01B9  C3				     ret
    133	01BA					     endp
    134				     ;-----------------------------------------------------
    135
    136
    137
    138				     ;=====================================================
    139				     ; Entry:	     CX	= length of string
    140				     ;
    141				     ; Result:	     DI	= right	offset for string with len CX
    142				     ;
    143				     ; Expected:     0 <= CX < 76d
    144				     ;
    145				     ; Destruction:  DI
    146				     ;=====================================================
    147	01BA			     CalcOffset	     proc
    148
    149	01BA  BF 004C				     mov di, 76d
    150	01BD  2B F9				     sub di, cx
    151	01BF  D1 EF D1 EF			     shr di, 2d
    152	01C3  D1 E7				     sal di, 1d
    153
    154	01C5  C3				     ret
    155	01C6					     endp
    156				     ;-----------------------------------------------------
    157
    158
    159
    160				     ;=====================================================
    161				     ; Entry:	     [80h]     = lenght	of string
    162				     ;		     [81h]     = space
    163				     ;		     [82h-...] = string
    164				     ;		     AH	       = color of string's symbols
    165				     ;		     ES:[DI]   = index of memory, from which printing will start
    166				     ;
    167				     ; Result:	     print string from command line (without first space)
    168				     ;		     started from es:[di]
    169				     ;
    170				     ; Expected:     STRING ISN'T EMPTY	and not	too long ( < 126d symbols)
    171				     ;
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 4
pretty_s.asm



    172				     ; Destruction:  DI, SI, AL, CX, BX
    173				     ;=====================================================
    174	01C6			     PrintString     proc
    175
    176	01C6  E8 000C				     call GetLength
    177	01C9  83 C3 02				     add bx, 02h
    178	01CC  8B F3				     mov si, bx
    179
    180	01CE  AC			    @@print: lodsb
    181	01CF  AB				     stosw
    182
    183	01D0  FE C9				     dec cl
    184	01D2  75 FA				     jne @@print
    185
    186	01D4  C3				     ret
    187	01D5					     endp
    188				     ;-----------------------------------------------------
    189
    190
    191
    192				     ;=====================================================
    193				     ; Entry:	     [80h] = length of string
    194				     ;
    195				     ; Result:	     CX	= length of string
    196				     ;		     BX	= 80h
    197				     ;
    198				     ; Expected:     -
    199				     ;
    200				     ; Destruction:  BX, CX
    201				     ;=====================================================
    202	01D5			     GetLength	     proc
    203
    204	01D5  BB 0080				     mov bx, 80h
    205	01D8  8A 0F				     mov cl, [bx]
    206	01DA  B5 00				     mov ch, 0h
    207	01DC  FE C9				     dec cl
    208
    209	01DE  C3				     ret
    210	01DF					     endp
    211				     ;-----------------------------------------------------
    212
    213
    214
    215				     ;=====================================================
    216				     ; Entry:	     AX	= wall's symbol
    217				     ;		     BX	= left central wall's symbol
    218				     ;		     CX	= right	central	wall's symbol
    219				     ;	     [stack] len = length of skipped symbols between walls
    220				     ;
    221				     ; Result:	     DX	= old CX (from Entry)
    222				     ;		     SI	= AX
    223				     ;		     CX	= len
    224				     ;
    225				     ; Expected:     DI	= right	offset
    226				     ;
    227				     ; Distruction:  DX, SI, CX
    228				     ;=====================================================
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 5
pretty_s.asm



    229	01DF			     DrawWalls	     proc    len
    230	01DF  55				     push bp
    231	01E0  8B EC				     mov bp, sp
    232
    233	01E2  8B D1				     mov dx, cx
    234	01E4  8B 4E 04				     mov cx, len
    235	01E7  D1 E1				     sal cx, 1d
    236
    237	01E9  8B F0				     mov si, ax
    238
    239	01EB  AB				     stosw
    240	01EC  03 F9				     add di, cx
    241	01EE  AB				     stosw
    242	01EF  2B F9				     sub di, cx
    243	01F1  83 EF 04				     sub di, 4d
    244
    245	01F4  B8 0001				     mov ax, 1d
    246	01F7  E8 FFB0				     call ChangeString
    247
    248	01FA  8B C3				     mov ax, bx
    249	01FC  AB				     stosw
    250	01FD  03 F9				     add di, cx
    251	01FF  8B C2				     mov ax, dx
    252	0201  AB				     stosw
    253	0202  2B F9				     sub di, cx
    254	0204  83 EF 04				     sub di, 4d
    255
    256	0207  B8 0001				     mov ax, 1d
    257	020A  E8 FF9D				     call ChangeString
    258
    259	020D  8B C6				     mov ax, si
    260	020F  AB				     stosw
    261	0210  03 F9				     add di, cx
    262	0212  AB				     stosw
    263	0213  2B F9				     sub di, cx
    264	0215  83 EF 04				     sub di, 4d
    265
    266	0218  B8 FFFE				     mov ax, -2d
    267	021B  E8 FF8C				     call ChangeString
    268
    269	021E  5D				     pop bp
    270	021F  58				     pop ax
    271	0220  59				     pop cx
    272	0221  50				     push ax
    273	0222  8B C6				     mov ax, si
    274
    275	0224  C3				     ret
    276	0225					     endp
    277				     ;-----------------------------------------------------
    278
    279
    280
    281				     ;=====================================================
    282				     ; Entry:	     AX	     = symbol of upleft	angle
    283				     ;		     BX	     = symbol of upright angle
    284				     ;		     CX	     = symbol of downleft angle
    285				     ;		     DX	     = symbol of downright angle
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 6
pretty_s.asm



    286				     ;	     [stack] mid1    = symbol of middle	of upside
    287				     ;	     [stack] mid2    = symbol of middle	of downside
    288				     ;	     [stack] len     = len of middle part
    289				     ;	     [stack] emp_str = the count of string between horisontal lines
    290				     ;
    291				     ; Result:	     AX	= returning address
    292				     ;		     BX	= 80h
    293				     ;		     SI	= old CX (from Entry)
    294				     ;		     CX	= len
    295				     ;
    296				     ; Expected:     argument's	direction -> CDECL, len	>= 0
    297				     ;		     DI	= right	offset
    298				     ;
    299				     ; Destruction:  AX, BX, CX, DX, SI
    300				     ;=====================================================
    301	0225			     DrawHorLines    proc    mid1, mid2, len, emp_str
    302	0225  55				     push bp
    303	0226  8B EC				     mov bp, sp
    304
    305	0228  8B F1				     mov si, cx
    306
    307	022A  50				     push ax
    308	022B  53				     push bx
    309	022C  FF 76 04				     push mid1
    310	022F  FF 76 08				     push len
    311	0232  57				     push di
    312	0233  E8 002F				     call BoundedHorLine
    313
    314	0236  8B CE				     mov cx, si
    315	0238  8B 46 0A				     mov ax, emp_str
    316	023B  05 0001				     add ax, 1d
    317	023E  E8 FF69				     call ChangeString
    318
    319	0241  51				     push cx
    320	0242  52				     push dx
    321	0243  FF 76 06				     push mid2
    322	0246  FF 76 08				     push len
    323	0249  57				     push di
    324	024A  E8 0018				     call BoundedHorLine
    325
    326	024D  8B 4E 08				     mov cx, len
    327	0250  8B 46 0A				     mov ax, emp_str
    328	0253  BB FFFF				     mov bx, -1d
    329	0256  F7 E3				     mul bx
    330	0258  2D 0001				     sub ax, 1d
    331	025B  E8 FF4C				     call ChangeString
    332
    333	025E  5D				     pop bp
    334	025F  58				     pop ax
    335	0260  83 C4 08				     add sp, 4h	* 2h
    336	0263  50				     push ax
    337	0264  C3				     ret
    338	0265					     endp
    339				     ;-----------------------------------------------------
    340
    341
    342
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 7
pretty_s.asm



    343				     ;=====================================================
    344				     ; BoundedHorLine(lbound, rbound, symb, len, ind)
    345				     ;
    346				     ; Entry:[stack] lbound  = symbol for line's start
    347				     ;	     [stack] rbound  = symbol for line's end
    348				     ;	     [stack] symb    = symbol of line's	middle
    349				     ;	     [stack] len     = len of line's middle
    350				     ;	     [stack] ind     = index from which	line will be printing (es:[ind])
    351				     ;
    352				     ; Result:	     DI	     = ind
    353				     ;		     AX	     = returing	address
    354				     ;		     CX	     = 0
    355				     ;
    356				     ; Expected:     argument's	direction -> Pascal, len >= 0
    357				     ;
    358				     ; Destruction:  AX, CX
    359				     ;=====================================================
    360	0265			     BoundedHorLine  proc
    361
    362	0265  55				     push bp
    363	0266  8B EC				     mov bp, sp
    364
    365	0268  8B 7E 04				     mov di, [bp + 4]
    366	026B  8B 4E 06				     mov cx, [bp + 6]
    367	026E  8B 46 0C				     mov ax, [bp + 12]
    368
    369	0271  AB				     stosw
    370
    371	0272  8B 46 08				     mov ax, [bp + 8]
    372
    373	0275  57				     push di
    374	0276  51				     push cx
    375	0277  50				     push ax
    376	0278  E8 0011				     call DrawHorLine
    377
    378	027B  8B 46 0A				     mov ax, [bp + 10]
    379	027E  AB				     stosw
    380
    381	027F  5F				     pop di
    382	0280  5F				     pop di
    383	0281  5F				     pop di
    384
    385	0282  83 EF 02				     sub di, 2d
    386
    387	0285  5D				     pop bp
    388	0286  58				     pop ax
    389	0287  83 C4 0A				     add sp, 5h	* 2h
    390	028A  50				     push ax
    391	028B  C3				     ret
    392	028C					     endp
    393				     ;-----------------------------------------------------
    394
    395
    396
    397				     ;=====================================================
    398				     ; DrawHorLine(symb, len, ind)
    399				     ;
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 8
pretty_s.asm



    400				     ; Entry:[stack] symb    = symbol which will be printing
    401				     ;	     [stack] len     = len of line
    402				     ;	     [stack] ind     = index of	memory,	from which hor line will be drawing
    403				     ;		     (real index = es:[ind])
    404				     ;
    405				     ; Result:	     ES:[DI] = index of	first byte after horisontal line
    406				     ;		     CX	     = 0
    407				     ;		     AX	     = symb
    408				     ;
    409				     ; Expected:     argument direction	-> CDECL, len >= 0
    410				     ;
    411				     ; Destruction:  AX, CX, DI
    412				     ;=====================================================
    413	028C			     DrawHorLine     proc symb,	len, ind
    414
    415	028C  55				     push bp
    416	028D  8B EC				     mov bp, sp
    417
    418	028F  8B 46 04				     mov ax, symb
    419	0292  8B 4E 06				     mov cx, len
    420	0295  8B 7E 08				     mov di, ind
    421
    422	0298  F3> AB				     rep stosw
    423
    424	029A  5D				     pop bp
    425	029B  C3				     ret
    426	029C					     endp
    427				     ;-----------------------------------------------------
    428
    429
    430
    431				     ;=====================================================
    432				     ; Entry:	     -
    433				     ; Result:	     Program ended
    434				     ; Expected:     -
    435				     ; Destruction:  AX
    436				     ;=====================================================
    437	029C			     Exit	     proc
    438
    439	029C  B8 4C00				     mov ax, 4c00h
    440	029F  CD 21				     int 21h
    441
    442	02A1  C3				     ret
    443	02A2					     endp
    444				     ;-----------------------------------------------------
    445
    446
    447
    448				     end start
Turbo Assembler	 Version 4.1	    02/15/26 14:23:01	    Page 9
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/15/26"
??FILENAME			  Text	 "pretty_s"
??TIME				  Text	 "14:23:01"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@PRINT				  Near	 DGROUP:01CE
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 PRETTY_S
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BOUNDEDHORLINE			  Near	 DGROUP:0265
CALCOFFSET			  Near	 DGROUP:01BA
CHANGESTRING			  Near	 DGROUP:01AA
DRAWHORLINE			  Near	 DGROUP:028C
DRAWHORLINES			  Near	 DGROUP:0225
DRAWWALLS			  Near	 DGROUP:01DF
EMP_STR				  Number [DGROUP:BP+000A]
EXIT				  Near	 DGROUP:029C
GETLENGTH			  Near	 DGROUP:01D5
IND				  Number [DGROUP:BP+0008]
LEN				  Number [DGROUP:BP+0006]
MAIN				  Near	 DGROUP:0106
MID1				  Number [DGROUP:BP+0004]
MID2				  Number [DGROUP:BP+0006]
PRINTSTRING			  Near	 DGROUP:01C6
SKIPSTRINGS			  Near	 DGROUP:019C
START				  Near	 DGROUP:0100
STR_LENGTH			  Number 000A
SYMB				  Number [DGROUP:BP+0004]

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  02A2 Word	  Public  CODE
