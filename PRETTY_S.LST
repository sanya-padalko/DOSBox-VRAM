Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 1
pretty_s.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5	      =000A		     STR_LENGTH	     equ 10d
      6
      7				     locals @@
      8
      9	0100  E8 0003		     start:	     call Main
     10	0103  E8 009E				     call Exit
     11
     12
     13				     ;=====================================================
     14				     ; Entry:	     -
     15				     ; Result:	     Program executed
     16				     ; Expected:     -
     17				     ; Destruction:  AX, BX, ES, DI, DS, SI, CL
     18				     ;=====================================================
     19	0106			     Main	     proc
     20
     21	0106  B8 0002				     mov ax, 02h
     22	0109  05 000A				     add ax, STR_LENGTH
     23	010C  E8 002D				     call SkipStrings
     24
     25	010F  E8 0053				     call GetLength
     26	0112  E8 0035				     call CalcOffset
     27
     28	0115  80 C1 02				     add cl, 2d
     29
     30	0118  50 55 8B EC C7 46	02+		     push 8a2fh			     ; upside
     31	      8A2F 5D
     32	0122  50 55 8B EC C7 46	02+		     push 8a5ch
     33	      8A5C 5D
     34	012C  50 55 8B EC C7 46	02+		     push 8ac4h
     35	      8AC4 5D
     36	0136  51				     push cx
     37	0137  57				     push di
     38	0138  E8 0032				     call BoundedHorLine
     39
     40
     41
     42	013B  C3				     ret
     43	013C					     endp
     44				     ;-----------------------------------------------------
     45
     46
     47
     48				     ;=====================================================
     49				     ; Entry:	     AX	= count	of empty string	before frame
     50				     ; Result:	     ES	on begin of (AX	+ 1)th string
     51				     ; Expected:     1 < AX < 21, also expect that 2 string will be entered
     52				     ; Destruction:  AX, ES, BX
     53				     ;=====================================================
     54	013C			     SkipStrings     proc
     55
     56	013C  05 0002				     add ax, 02h
     57	013F  BB 000A				     mov bx, 0ah
Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 2
pretty_s.asm



     58	0142  F7 E3				     mul bx
     59	0144  05 B800				     add ax, 0b800h
     60	0147  8E C0				     mov es, ax
     61
     62	0149  C3				     ret
     63	014A					     endp
     64				     ;-----------------------------------------------------
     65
     66
     67
     68				     ;=====================================================
     69				     ; Entry:	     CX	= length of string
     70				     ;
     71				     ; Result:	     DI	= right	offset for string with len CX
     72				     ;
     73				     ; Expected:     0 <= CX < 76d
     74				     ;
     75				     ; Destruction:  DI
     76				     ;=====================================================
     77	014A			     CalcOffset	     proc
     78
     79	014A  BF 004C				     mov di, 76d
     80	014D  2B F9				     sub di, cx
     81	014F  D1 EF D1 EF			     shr di, 2d
     82	0153  D1 E7				     sal di, 1d
     83
     84	0155  C3				     ret
     85	0156					     endp
     86				     ;-----------------------------------------------------
     87
     88
     89
     90				     ;=====================================================
     91				     ; Entry:	     [80h]     = lenght	of string
     92				     ;		     [81h]     = space
     93				     ;		     [82h-...] = string
     94				     ;		     AH	       = color of string's symbols
     95				     ;		     ES:[DI]   = index of memory, from which printing will start
     96				     ;
     97				     ; Result:	     print string from command line (without first space)
     98				     ;		     started from es:[di]
     99				     ;
    100				     ; Expected:     STRING ISN'T EMPTY	and not	too long ( < 126d symbols)
    101				     ;
    102				     ; Destruction:  DI, SI, AL, CX, BX
    103				     ;=====================================================
    104	0156			     PrintString     proc
    105
    106	0156  E8 000C				     call GetLength
    107	0159  83 C3 02				     add bx, 02h
    108	015C  8B F3				     mov si, bx
    109
    110	015E  AC			    @@print: lodsb
    111	015F  AB				     stosw
    112
    113	0160  FE C9				     dec cl
    114	0162  75 FA				     jne @@print
Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 3
pretty_s.asm



    115
    116	0164  C3				     ret
    117	0165					     endp
    118				     ;-----------------------------------------------------
    119
    120
    121
    122				     ;=====================================================
    123				     ; Entry:	     [80h] = length of string
    124				     ;
    125				     ; Result:	     CX	= length of string
    126				     ;		     BX	= 80h
    127				     ;
    128				     ; Expected:     -
    129				     ;
    130				     ; Destruction:  BX, CX
    131				     ;=====================================================
    132	0165			     GetLength	     proc
    133
    134	0165  BB 0080				     mov bx, 80h
    135	0168  8A 0F				     mov cl, [bx]
    136	016A  B5 00				     mov ch, 0h
    137
    138	016C  C3				     ret
    139	016D					     endp
    140				     ;-----------------------------------------------------
    141
    142
    143
    144				     ;=====================================================
    145				     ; BoundedHorLine(lbound, rbound, symb, len, ind)
    146				     ;
    147				     ; Entry:	     lbound  = symbol for line's start
    148				     ;		     rbound  = symbol for line's end
    149				     ;		     symb    = symbol of line's	middle
    150				     ;		     len     = len of line's middle
    151				     ;		     ind     = index from which	line will be printing (es:[ind])
    152				     ;
    153				     ; Result:	     di	     = ind
    154				     ;		     AX	     = returing	address
    155				     ;		     CX	     = 0
    156				     ;
    157				     ; Expected:     argument direction	-> Pascal, len >= 0
    158				     ;
    159				     ; Destruction:  AX, CX, DI
    160				     ;=====================================================
    161	016D			     BoundedHorLine  proc
    162
    163	016D  55				     push bp
    164	016E  8B EC				     mov bp, sp
    165
    166	0170  8B 7E 04				     mov di, [bp + 4]
    167	0173  8B 4E 06				     mov cx, [bp + 6]
    168	0176  8B 46 0C				     mov ax, [bp + 12]
    169
    170	0179  AB				     stosw
    171
Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 4
pretty_s.asm



    172	017A  8B 46 08				     mov ax, [bp + 8]
    173
    174	017D  57				     push di
    175	017E  51				     push cx
    176	017F  50				     push ax
    177	0180  E8 0011				     call DrawHorLine
    178
    179	0183  8B 46 0A				     mov ax, [bp + 10]
    180	0186  AB				     stosw
    181
    182	0187  5F				     pop di
    183	0188  5F				     pop di
    184	0189  5F				     pop di
    185
    186	018A  83 EF 02				     sub di, 2d
    187
    188	018D  5D				     pop bp
    189	018E  58				     pop ax
    190	018F  83 C4 0A				     add sp, 5h	* 2h
    191	0192  50				     push ax
    192	0193  C3				     ret
    193	0194					     endp
    194				     ;-----------------------------------------------------
    195
    196
    197
    198				     ;=====================================================
    199				     ; DrawHorLine(symb, len, ind)
    200				     ;
    201				     ; Entry:	     symb    = symbol which will be printing
    202				     ;		     len     = len of line
    203				     ;		     ind     = index of	memory,	from which hor line will be drawing
    204				     ;		     (real index = es:[ind])
    205				     ;
    206				     ; Result:	     ES:[DI] = index of	first byte after horisontal line
    207				     ;		     CX	     = 0
    208				     ;		     AX	     = symb
    209				     ;
    210				     ; Expected:     argument direction	-> CDECL, len >= 0
    211				     ;
    212				     ; Destruction:  AX, CX, DI
    213				     ;=====================================================
    214	0194			     DrawHorLine     proc symb,	len, ind
    215
    216	0194  55				     push bp
    217	0195  8B EC				     mov bp, sp
    218
    219	0197  8B 46 04				     mov ax, symb
    220	019A  8B 4E 06				     mov cx, len
    221	019D  8B 7E 08				     mov di, ind
    222
    223	01A0  F3> AB				     rep stosw
    224
    225	01A2  5D				     pop bp
    226	01A3  C3				     ret
    227	01A4					     endp
    228				     ;-----------------------------------------------------
Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 5
pretty_s.asm



    229
    230
    231
    232				     ;=====================================================
    233				     ; Entry:	     -
    234				     ; Result:	     Program ended
    235				     ; Expected:     -
    236				     ; Destruction:  AX
    237				     ;=====================================================
    238	01A4			     Exit	     proc
    239
    240	01A4  B8 4C00				     mov ax, 4c00h
    241	01A7  CD 21				     int 21h
    242
    243	01A9  C3				     ret
    244	01AA					     endp
    245				     ;-----------------------------------------------------
    246
    247
    248
    249				     end start
Turbo Assembler	 Version 4.1	    02/14/26 23:54:29	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/14/26"
??FILENAME			  Text	 "pretty_s"
??TIME				  Text	 "23:54:29"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@PRINT				  Near	 DGROUP:015E
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 PRETTY_S
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BOUNDEDHORLINE			  Near	 DGROUP:016D
CALCOFFSET			  Near	 DGROUP:014A
DRAWHORLINE			  Near	 DGROUP:0194
EXIT				  Near	 DGROUP:01A4
GETLENGTH			  Near	 DGROUP:0165
IND				  Number [DGROUP:BP+0008]
LEN				  Number [DGROUP:BP+0006]
MAIN				  Near	 DGROUP:0106
PRINTSTRING			  Near	 DGROUP:0156
SKIPSTRINGS			  Near	 DGROUP:013C
START				  Near	 DGROUP:0100
STR_LENGTH			  Number 000A
SYMB				  Number [DGROUP:BP+0004]

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01AA Word	  Public  CODE
