Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 1
pretty_s.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5	      =000A		     STR_LENGTH	     equ 10d
      6
      7				     locals @@
      8
      9	0100  E8 0003		     start:	     call Main
     10	0103  E8 00AF				     call Exit
     11
     12
     13				     ;=====================================================
     14				     ; Entry:	     -
     15				     ; Result:	     Program executed
     16				     ; Expected:     -
     17				     ; Destruction:  AX, BX, ES, DI, DS, SI, CL
     18				     ;=====================================================
     19	0106			     Main	     proc
     20
     21	0106  B8 0002				     mov ax, 02h
     22	0109  E8 0033				     call SkipStrings
     23
     24	010C  E8 0067				     call GetLength
     25	010F  E8 0049				     call CalcOffset
     26
     27	0112  B8 FFFF				     mov ax, -1h
     28	0115  E8 0035				     call ChangeString
     29
     30	0118  80 C1 02				     add cl, 2d
     31
     32	011B  50 55 8B EC C7 46	02+		     push 8a2fh			     ; upside
     33	      8A2F 5D
     34	0125  50 55 8B EC C7 46	02+		     push 8a5ch
     35	      8A5C 5D
     36	012F  50 55 8B EC C7 46	02+		     push 8ac4h
     37	      8AC4 5D
     38	0139  51				     push cx
     39	013A  57				     push di
     40	013B  E8 0040				     call BoundedHorLine
     41
     42	013E  C3				     ret
     43	013F					     endp
     44				     ;-----------------------------------------------------
     45
     46
     47
     48				     ;=====================================================
     49				     ; Entry:	     AX	= count	of empty string	before frame
     50				     ; Result:	     ES	on begin of (AX	+ 1)th string
     51				     ; Expected:     1 < AX < 21, also expect that 2 string will be entered
     52				     ; Destruction:  AX, ES, BX
     53				     ;=====================================================
     54	013F			     SkipStrings     proc
     55
     56	013F  05 0002				     add ax, 02h
     57	0142  BB 000A				     mov bx, 0ah
Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 2
pretty_s.asm



     58	0145  F7 E3				     mul bx
     59	0147  05 B800				     add ax, 0b800h
     60	014A  8E C0				     mov es, ax
     61
     62	014C  C3				     ret
     63	014D					     endp
     64				     ;-----------------------------------------------------
     65
     66
     67
     68				     ;=====================================================
     69				     ; Entry:	     AX	= the number of	lines to change	to
     70				     ;		     ES	= ...
     71				     ; Result:	     ES	= old ES + AX strings
     72				     ;		     AX	= ES
     73				     ; Expected:     -
     74				     ;
     75				     ; Destruction:  ES, AX
     76				     ;=====================================================
     77	014D			     ChangeString    proc
     78
     79	014D  53				     push bx
     80	014E  BB 000A				     mov bx, 10d
     81	0151  F7 E3				     mul bx
     82
     83	0153  8C C3				     mov bx, es
     84	0155  03 C3				     add ax, bx
     85	0157  8E C0				     mov es, ax
     86
     87	0159  5B				     pop bx
     88	015A  C3				     ret
     89	015B					     endp
     90				     ;-----------------------------------------------------
     91
     92
     93
     94				     ;=====================================================
     95				     ; Entry:	     CX	= length of string
     96				     ;
     97				     ; Result:	     DI	= right	offset for string with len CX
     98				     ;
     99				     ; Expected:     0 <= CX < 76d
    100				     ;
    101				     ; Destruction:  DI
    102				     ;=====================================================
    103	015B			     CalcOffset	     proc
    104
    105	015B  BF 004C				     mov di, 76d
    106	015E  2B F9				     sub di, cx
    107	0160  D1 EF D1 EF			     shr di, 2d
    108	0164  D1 E7				     sal di, 1d
    109
    110	0166  C3				     ret
    111	0167					     endp
    112				     ;-----------------------------------------------------
    113
    114
Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 3
pretty_s.asm



    115
    116				     ;=====================================================
    117				     ; Entry:	     [80h]     = lenght	of string
    118				     ;		     [81h]     = space
    119				     ;		     [82h-...] = string
    120				     ;		     AH	       = color of string's symbols
    121				     ;		     ES:[DI]   = index of memory, from which printing will start
    122				     ;
    123				     ; Result:	     print string from command line (without first space)
    124				     ;		     started from es:[di]
    125				     ;
    126				     ; Expected:     STRING ISN'T EMPTY	and not	too long ( < 126d symbols)
    127				     ;
    128				     ; Destruction:  DI, SI, AL, CX, BX
    129				     ;=====================================================
    130	0167			     PrintString     proc
    131
    132	0167  E8 000C				     call GetLength
    133	016A  83 C3 02				     add bx, 02h
    134	016D  8B F3				     mov si, bx
    135
    136	016F  AC			    @@print: lodsb
    137	0170  AB				     stosw
    138
    139	0171  FE C9				     dec cl
    140	0173  75 FA				     jne @@print
    141
    142	0175  C3				     ret
    143	0176					     endp
    144				     ;-----------------------------------------------------
    145
    146
    147
    148				     ;=====================================================
    149				     ; Entry:	     [80h] = length of string
    150				     ;
    151				     ; Result:	     CX	= length of string
    152				     ;		     BX	= 80h
    153				     ;
    154				     ; Expected:     -
    155				     ;
    156				     ; Destruction:  BX, CX
    157				     ;=====================================================
    158	0176			     GetLength	     proc
    159
    160	0176  BB 0080				     mov bx, 80h
    161	0179  8A 0F				     mov cl, [bx]
    162	017B  B5 00				     mov ch, 0h
    163
    164	017D  C3				     ret
    165	017E					     endp
    166				     ;-----------------------------------------------------
    167
    168
    169
    170				     ;=====================================================
    171				     ; BoundedHorLine(lbound, rbound, symb, len, ind)
Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 4
pretty_s.asm



    172				     ;
    173				     ; Entry:	     lbound  = symbol for line's start
    174				     ;		     rbound  = symbol for line's end
    175				     ;		     symb    = symbol of line's	middle
    176				     ;		     len     = len of line's middle
    177				     ;		     ind     = index from which	line will be printing (es:[ind])
    178				     ;
    179				     ; Result:	     di	     = ind
    180				     ;		     AX	     = returing	address
    181				     ;		     CX	     = 0
    182				     ;
    183				     ; Expected:     argument direction	-> Pascal, len >= 0
    184				     ;
    185				     ; Destruction:  AX, CX, DI
    186				     ;=====================================================
    187	017E			     BoundedHorLine  proc
    188
    189	017E  55				     push bp
    190	017F  8B EC				     mov bp, sp
    191
    192	0181  8B 7E 04				     mov di, [bp + 4]
    193	0184  8B 4E 06				     mov cx, [bp + 6]
    194	0187  8B 46 0C				     mov ax, [bp + 12]
    195
    196	018A  AB				     stosw
    197
    198	018B  8B 46 08				     mov ax, [bp + 8]
    199
    200	018E  57				     push di
    201	018F  51				     push cx
    202	0190  50				     push ax
    203	0191  E8 0011				     call DrawHorLine
    204
    205	0194  8B 46 0A				     mov ax, [bp + 10]
    206	0197  AB				     stosw
    207
    208	0198  5F				     pop di
    209	0199  5F				     pop di
    210	019A  5F				     pop di
    211
    212	019B  83 EF 02				     sub di, 2d
    213
    214	019E  5D				     pop bp
    215	019F  58				     pop ax
    216	01A0  83 C4 0A				     add sp, 5h	* 2h
    217	01A3  50				     push ax
    218	01A4  C3				     ret
    219	01A5					     endp
    220				     ;-----------------------------------------------------
    221
    222
    223
    224				     ;=====================================================
    225				     ; DrawHorLine(symb, len, ind)
    226				     ;
    227				     ; Entry:	     symb    = symbol which will be printing
    228				     ;		     len     = len of line
Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 5
pretty_s.asm



    229				     ;		     ind     = index of	memory,	from which hor line will be drawing
    230				     ;		     (real index = es:[ind])
    231				     ;
    232				     ; Result:	     ES:[DI] = index of	first byte after horisontal line
    233				     ;		     CX	     = 0
    234				     ;		     AX	     = symb
    235				     ;
    236				     ; Expected:     argument direction	-> CDECL, len >= 0
    237				     ;
    238				     ; Destruction:  AX, CX, DI
    239				     ;=====================================================
    240	01A5			     DrawHorLine     proc symb,	len, ind
    241
    242	01A5  55				     push bp
    243	01A6  8B EC				     mov bp, sp
    244
    245	01A8  8B 46 04				     mov ax, symb
    246	01AB  8B 4E 06				     mov cx, len
    247	01AE  8B 7E 08				     mov di, ind
    248
    249	01B1  F3> AB				     rep stosw
    250
    251	01B3  5D				     pop bp
    252	01B4  C3				     ret
    253	01B5					     endp
    254				     ;-----------------------------------------------------
    255
    256
    257
    258				     ;=====================================================
    259				     ; Entry:	     -
    260				     ; Result:	     Program ended
    261				     ; Expected:     -
    262				     ; Destruction:  AX
    263				     ;=====================================================
    264	01B5			     Exit	     proc
    265
    266	01B5  B8 4C00				     mov ax, 4c00h
    267	01B8  CD 21				     int 21h
    268
    269	01BA  C3				     ret
    270	01BB					     endp
    271				     ;-----------------------------------------------------
    272
    273
    274
    275				     end start
Turbo Assembler	 Version 4.1	    02/14/26 24:24:49	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/14/26"
??FILENAME			  Text	 "pretty_s"
??TIME				  Text	 "24:24:49"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@PRINT				  Near	 DGROUP:016F
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 PRETTY_S
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BOUNDEDHORLINE			  Near	 DGROUP:017E
CALCOFFSET			  Near	 DGROUP:015B
CHANGESTRING			  Near	 DGROUP:014D
DRAWHORLINE			  Near	 DGROUP:01A5
EXIT				  Near	 DGROUP:01B5
GETLENGTH			  Near	 DGROUP:0176
IND				  Number [DGROUP:BP+0008]
LEN				  Number [DGROUP:BP+0006]
MAIN				  Near	 DGROUP:0106
PRINTSTRING			  Near	 DGROUP:0167
SKIPSTRINGS			  Near	 DGROUP:013F
START				  Near	 DGROUP:0100
STR_LENGTH			  Number 000A
SYMB				  Number [DGROUP:BP+0004]

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01BB Word	  Public  CODE
